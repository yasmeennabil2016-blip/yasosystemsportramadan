<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
 <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0"> <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>المسابقة الرمضانية - YasoSystem</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
  <!-- شاشة الدخول الرئيسية -->
  <div id="loginScreen" class="screen active">
    <div class="ramadan-decorations">
      <div class="lantern lantern-1">
        <div class="lantern-body"></div>
        <div class="lantern-light"></div>
      </div>
      <div class="lantern lantern-2">
        <div class="lantern-body"></div>
        <div class="lantern-light"></div>
      </div>
      <div class="stars">
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
      </div>
      <div class="crescent-moon"></div>
    </div>

    <div class="login-container">
      <div class="logo-section">
        <div class="logo">
          <i class="fas fa-trophy"></i>
          <span>YasoSystem</span>
        </div>
        <div class="animated-circles">
          <div class="circle circle-1"></div>
          <div class="circle circle-2"></div>
          <div class="circle circle-3"></div>
        </div>
      </div>

      <div class="welcome-message">
        <h1>أهلاً بك يا بطل في المسابقة الرمضانية</h1>
        <p>شارك  وغير روتينك يا بطل </p>
      </div>

      <div class="login-box">
        <h2>تسجيل الدخول</h2>
        <form id="loginForm">
          <div class="input-group">
            <i class="fas fa-key"></i>
            <input type="text" id="loginCode" placeholder="كود الدخول أو البريد الإلكتروني" required>
          </div>
          <button type="submit" class="login-btn">
            <span>دخول</span>
            <i class="fas fa-arrow-left"></i>
          </button>
        </form>
      </div>

      <div class="register-section">
        <p>ليس لديك كود؟</p>
        <button id="registerBtn" class="register-btn">
          <span>سجل معنا - شارك واكسب</span>
          <i class="fas fa-user-plus"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- شاشة التسجيل -->
  <div id="registerScreen" class="screen">
    <div class="register-container">
      <div class="register-header">
        <h2>تسجيل جديد</h2>
        <button class="back-btn" onclick="showScreen('loginScreen')">
          <i class="fas fa-arrow-right"></i>
        </button>
      </div>
      
      <form id="registerForm" class="register-form">
        <div class="input-group">
          <i class="fas fa-user"></i>
          <input type="text" id="regName" placeholder="الاسم الكامل" required>
        </div>
        
        <div class="input-group">
          <i class="fas fa-phone"></i>
          <input type="tel" id="regPhone" placeholder="رقم الهاتف" required>
        </div>
        
        <div class="input-group">
          <i class="fas fa-map-marker-alt"></i>
          <select id="regGovernorate" required>
            <option value="">اختر المحافظة</option>
            <option value="القاهرة">القاهرة</option>
          <option value="الجيزة">الجيزة</option>
            <option value="الإسكندرية">الإسكندرية</option>
            <option value="الدقهلية">الدقهلية</option>
            <option value="الشرقية">الشرقية</option>
            <option value="القليوبية">القليوبية</option>
            <option value="كفر الشيخ">كفر الشيخ</option>
            <option value="الغربية">الغربية</option>
            <option value="المنوفية">المنوفية</option>
            <option value="البحيرة">البحيرة</option>
            <option value="بني سويف">بني سويف</option>
            <option value="الفيوم">الفيوم</option>
            <option value="المنيا">المنيا</option>
            <option value="أسيوط">أسيوط</option>
            <option value="سوهاج">سوهاج</option>
            <option value="قنا">قنا</option>
            <option value="الأقصر">الأقصر</option>
            <option value="أسوان">أسوان</option>
            <option value="البحر الأحمر">البحر الأحمر</option>
      
            <option value="غير مسجله المحافظة">غير مسجله المحافظة</option>
            <option value="دمياط ">دمياط</option>
            <option value="جنوب سيناء">جنوب سيناء</option>
          </select>
        </div>
        
        <div class="input-group">
          <i class="fas fa-chalkboard-teacher"></i>
          <select id="regTrainer" required>
            <option value="">اختر المدرب</option>
          </select>
        </div>
        
        <div class="input-group">
          <i class="fas fa-info-circle"></i>
          <select id="regSource" required>
            <option value="">عرفتنا منين؟</option>
            <option value="الموقع">من موقعنا</option>
            <option value="فيسبوك">من الفيسبوك</option>
            <option value="صديق">من صديق</option>
            <option value="أخرى">أخرى</option>
          </select>
        </div>
        
        <button type="submit" class="submit-btn">
          <span>إرسال الطلب</span>
          <i class="fas fa-paper-plane"></i>
        </button>
      </form>
    </div>
  </div>

  <!-- شاشة المدير -->
  <div id="adminScreen" class="screen">
    <div class="dashboard-container">
      <div class="dashboard-header">
        <div class="logo-small">
          <i class="fas fa-trophy"></i>
          <span>YasoSystem - لوحة المدير</span>
        </div>
        <button class="logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>خروج</span>
        </button>
      </div>

      <div class="dashboard-tabs">
        <button class="tab-btn active" onclick="showAdminTab('trainerActivation')">
          <i class="fas fa-user-check"></i>
          <span>تفعيل كود المدرب</span>
        </button>
        <button class="tab-btn" onclick="showAdminTab('registrationRequests')">
          <i class="fas fa-user-plus"></i>
          <span>طلبات التسجيل</span>
        </button>
        <button class="tab-btn" onclick="showAdminTab('questionBank')">
          <i class="fas fa-question-circle"></i>
          <span>بنك الأسئلة</span>
        </button>
        <button class="tab-btn" onclick="showAdminTab('logoUpload')">
          <i class="fas fa-image"></i>
          <span>رفع الصور</span>
        </button>
      </div>

      <div class="dashboard-content">
        <!-- تفعيل كود المدرب -->
        <div id="trainerActivation" class="tab-content active">
          <div class="section-header">
            <h3>تفعيل كود المدرب</h3>
          </div>
          
          <form id="trainerForm" class="trainer-form">
            <div class="form-row">
              <div class="input-group">
                <label>اسم المدرب</label>
                <input type="text" id="trainerName" required>
              </div>
              <div class="input-group">
                <label>رقم الهاتف</label>
                <input type="tel" id="trainerPhone" required>
              </div>
            </div>
            
            <div class="form-row">
              <div class="input-group">
                <label>المبلغ المدفوع</label>
                <input type="number" id="trainerAmount" required>
              </div>
              <div class="input-group">
                <label>كود الدخول</label>
                <input type="text" id="trainerCode" required>
              </div>
            </div>
            
            <div class="form-row">
              <div class="checkbox-group">
                <input type="checkbox" id="allowEdit">
                <label for="allowEdit">السماح بتعديل الأسئلة</label>
              </div>
            </div>
            
            <button type="submit" class="submit-btn">
              <span>تفعيل المدرب</span>
              <i class="fas fa-check"></i>
            </button>
          </form>

          <div class="trainers-table">
            <h4>المدربون المفعلون</h4>
            <table id="trainersTable">
              <thead>
                <tr>
                  <th>#</th>
                  <th>اسم المدرب</th>
                  <th>الهاتف</th>
                  <th>المبلغ</th>
                  <th>كود الدخول</th>
                  <th>تعديل الأسئلة</th>
                  <th>إجراءات</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- طلبات التسجيل -->
        <div id="registrationRequests" class="tab-content">
          <div class="section-header">
            <h3>طلبات التسجيل الجديدة</h3>
          </div>
          
          <div class="requests-table">
            <table id="requestsTable">
              <thead>
                <tr>
                  <th>#</th>
                  <th>الاسم</th>
                  <th>الهاتف</th>
                  <th>المحافظة</th>
                  <th>المدرب</th>
                  <th>المصدر</th>
                  <th>إجراءات</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- بنك الأسئلة -->
        <div id="questionBank" class="tab-content">
          <div class="section-header">
            <h3>بنك الأسئلة</h3>
          </div>
          
          <form id="questionForm" class="question-form">
            <div class="form-row">
              <div class="input-group">
                <label>رقم اليوم</label>
                <input type="number" id="questionDay" min="1" max="30" required>
              </div>
              <div class="input-group">
                <label>تاريخ الفتح</label>
                <input type="datetime-local" id="questionOpenDate" required>
              </div>
              <div class="input-group">
                <label>تاريخ الإغلاق</label>
                <input type="datetime-local" id="questionCloseDate" required>
              </div>
            </div>
            
            <div class="input-group">
              <label>نص السؤال</label>
              <textarea id="questionText" rows="3" required></textarea>
            </div>
            
            <div class="input-group">
              <label>صورة السؤال (اختياري)</label>
              <input type="file" id="questionImage" accept="image/*">
            </div>
            
            <div class="answers-section">
              <h4>الإجابات</h4>
              <div class="answer-group">
                <input type="text" id="answer1" placeholder="الإجابة الأولى" required>
                <input type="radio" name="correctAnswer" value="1" required>
                <label>صحيحة</label>
              </div>
              <div class="answer-group">
                <input type="text" id="answer2" placeholder="الإجابة الثانية" required>
                <input type="radio" name="correctAnswer" value="2">
                <label>صحيحة</label>
              </div>
              <div class="answer-group">
                <input type="text" id="answer3" placeholder="الإجابة الثالثة (اختياري)">
                <input type="radio" name="correctAnswer" value="3">
                <label>صحيحة</label>
              </div>
              <div class="answer-group">
                <input type="text" id="answer4" placeholder="الإجابة الرابعة (اختياري)">
                <input type="radio" name="correctAnswer" value="4">
                <label>صحيحة</label>
              </div>
            </div>
            
            <button type="submit" class="submit-btn">
              <span>حفظ السؤال</span>
              <i class="fas fa-save"></i>
            </button>
          </form>

          <div class="questions-list">
            <h4>الأسئلة المحفوظة</h4>
            <div id="questionsList"></div>
          </div>
        </div>

        <!-- رفع الصور -->
        <div id="logoUpload" class="tab-content">
          <div class="section-header">
            <h3>رفع شعارات المدربين</h3>
          </div>
          
          <form id="logoForm" class="logo-form">
            <div class="input-group">
              <label>اختر المدرب</label>
              <select id="logoTrainer" required>
                <option value="">اختر المدرب</option>
              </select>
            </div>
            
            <div class="input-group">
              <label>رفع الشعار</label>
              <input type="file" id="logoFile" accept="image/*" required>
            </div>
            
            <button type="submit" class="submit-btn">
              <span>رفع الشعار</span>
              <i class="fas fa-upload"></i>
            </button>
          </form>

          <div class="logos-gallery">
            <h4>الشعارات المرفوعة</h4>
            <div id="logosGallery"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- شاشة المدرب -->
  <div id="trainerScreen" class="screen">
    <div class="dashboard-container">
      <div class="dashboard-header">
        <div class="logo-small">
          <i class="fas fa-chalkboard-teacher"></i>
          <span>YasoSystem - لوحة المدرب</span>
        </div>
        <div class="trainer-logo" id="trainerLogo"></div>
        <button class="logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>خروج</span>
        </button>
      </div>

      <div class="dashboard-tabs">
        <button class="tab-btn active" onclick="showTrainerTab('questions')">
          <i class="fas fa-question-circle"></i>
          <span>الأسئلة</span>
        </button>
        <button class="tab-btn" onclick="showTrainerTab('reports')">
          <i class="fas fa-chart-bar"></i>
          <span>التقارير</span>
        </button>
      </div>

      <div class="dashboard-content">
        <!-- الأسئلة -->
        <div id="questions" class="tab-content active">
          <div class="section-header">
            <h3>جميع الأسئلة</h3>
          </div>
          
          <div class="questions-grid" id="trainerQuestions"></div>
        </div>

        <!-- التقارير -->
        <div id="reports" class="tab-content">
          <div class="section-header">
            <h3>تقارير العملاء</h3>
            <button class="export-btn" onclick="exportReport()">
              <i class="fas fa-file-excel"></i>
              <span>تصدير إلى Excel</span>
            </button>
          </div>
          
          <div class="reports-table">
            <table id="reportsTable">
              <thead>
                <tr>
                  <th>#</th>
                  <th>اسم العميل</th>
                  <th>المحافظة</th>
                  <th>رقم الهاتف</th>
                  <th>الإجابات الصحيحة</th>
                  <th>الإجابات الخاطئة</th>
                  <th>النسبة المئوية</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- شاشة العميل -->
  <div id="clientScreen" class="screen">
    <div class="dashboard-container">
      <div class="dashboard-header">
        <div class="logo-small">
          <i class="fas fa-user"></i>
          <span>YasoSystem - لوحة العميل</span>
        </div>
        <div class="client-info">
          <span id="clientName"></span>
        </div>
        <button class="logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>خروج</span>
        </button>
      </div>

      <div class="client-content">
        <div class="survey-section">
          <button id="surveyBtn" class="survey-btn">
            <span>استبيان الرأي</span>
            <i class="fas fa-poll"></i>
          </button>
        </div>

        <div class="challenges-section">
          <h3>تحديات الشهر</h3>
          <div class="challenges-grid" id="challengesGrid"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- نافذة السؤال المنبثقة -->
  <div id="questionModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalQuestionTitle">سؤال اليوم</h3>
        <button class="close-btn" onclick="closeModal('questionModal')">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div id="modalQuestionImage"></div>
        <p id="modalQuestionText"></p>
        <div id="modalAnswers" class="answers-list"></div>
        <button id="submitAnswerBtn" class="submit-btn">
          <span>إرسال الإجابة</span>
          <i class="fas fa-check"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- نافذة الاستبيان المنبثقة -->
  <div id="surveyModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>استبيان الرأي</h3>
        <button class="close-btn" onclick="closeModal('surveyModal')">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="surveyForm">
          <div class="survey-question">
            <label>كيف تقيم تجربتك مع المسابقة؟</label>
            <div class="rating-stars">
              <input type="radio" name="experience" value="5" id="exp5">
              <label for="exp5"><i class="fas fa-star"></i></label>
              <input type="radio" name="experience" value="4" id="exp4">
              <label for="exp4"><i class="fas fa-star"></i></label>
              <input type="radio" name="experience" value="3" id="exp3">
              <label for="exp3"><i class="fas fa-star"></i></label>
              <input type="radio" name="experience" value="2" id="exp2">
              <label for="exp2"><i class="fas fa-star"></i></label>
              <input type="radio" name="experience" value="1" id="exp1">
              <label for="exp1"><i class="fas fa-star"></i></label>
            </div>
          </div>
          
          <div class="survey-question">
            <label>هل الأسئلة مناسبة لمستواك؟</label>
            <div class="radio-group">
              <input type="radio" name="difficulty" value="easy" id="easy">
              <label for="easy">سهلة</label>
              <input type="radio" name="difficulty" value="medium" id="medium">
              <label for="medium">متوسطة</label>
              <input type="radio" name="difficulty" value="hard" id="hard">
              <label for="hard">صعبة</label>
            </div>
          </div>
          
          <div class="survey-question">
            <label>ما رأيك في تصميم الموقع؟</label>
            <textarea name="design_feedback" rows="3" placeholder="اكتب رأيك هنا..."></textarea>
          </div>
          
          <div class="survey-question">
            <label>هل تنصح أصدقاءك بالمشاركة؟</label>
            <div class="radio-group">
              <input type="radio" name="recommend" value="yes" id="rec_yes">
              <label for="rec_yes">نعم</label>
              <input type="radio" name="recommend" value="no" id="rec_no">
              <label for="rec_no">لا</label>
            </div>
          </div>
          
          <button type="submit" class="submit-btn">
            <span>إرسال الاستبيان</span>
            <i class="fas fa-paper-plane"></i>
          </button>
        </form>
      </div>
    </div>
  </div>

  <script src="script.js"></script><!-- ملف المزامنة مع Firebase -->
<!-- أولاً: Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

<!-- ثانياً: ملف المزامنة (الخاص بك) -->
<script src="sync.js"></script>

<!-- ثالثاً: ملفك الأصلي (إذا كان منفصل) -->
<script src="script.js">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
  import { getStorage } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-storage.js";
  
  window.initializeFirebase = function(config) {
    const app = initializeApp(config);
    window.db = getFirestore(app);
    window.storage = getStorage(app);
    console.log("✅ Firebase ready");
    return app;
  };
<script src="sync.js" type="module"></script></script>
</body>
</html>
